<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.9 -->

<!DOCTYPE rfc SYSTEM "../Tools/rfcbootstrap/rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="draft-nottingham-cache-header-00" category="std">

  <front>
    <title abbrev="Cache Header">The Cache HTTP Response Header</title>

    <author initials="M." surname="Nottingham" fullname="Mark Nottingham">
      <organization>Fastly</organization>
      <address>
        <email>mnot@mnot.net</email>
        <uri>https://www.mnot.net/</uri>
      </address>
    </author>

    <date year="2018"/>

    <area>General</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>To aid debugging, HTTP caches often append headers to a response detailing how they handled the request. This specification codifies that practice and updates it for HTTP’s current caching model.</t>



    </abstract>


    <note title="Note to Readers">


<t><spanx style="emph">RFC EDITOR: please remove this section before publication</spanx></t>

<t>The issues list for this draft can be found at <eref target="https://github.com/mnot/I-D/labels/cache-header">https://github.com/mnot/I-D/labels/cache-header</eref>.</t>

<t>The most recent (often, unpublished) draft is at <eref target="https://mnot.github.io/I-D/cache-header/">https://mnot.github.io/I-D/cache-header/</eref>.</t>

<t>Recent changes are listed at <eref target="https://github.com/mnot/I-D/commits/gh-pages/cache-header">https://github.com/mnot/I-D/commits/gh-pages/cache-header</eref>.</t>

<t>See also the draft’s current status in the IETF datatracker, at
<eref target="https://datatracker.ietf.org/doc/draft-nottingham-cache-header/">https://datatracker.ietf.org/doc/draft-nottingham-cache-header/</eref>.</t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>To aid debugging, HTTP caches often append headers to a response detailing how they handled the request.</t>

<t>Unfortunately, the semantics of these headers are often unclear, and both the semantics and syntax used vary greatly between implementations.</t>

<t>This specification defines a single, new HTTP response header field, “Cache” for this purpose.</t>

<t>For example:</t>

<figure><artwork type="example"><![CDATA[
Cache: MISS; node="FooCDN edge"; fresh=-45; age=200; latency=98,
       HIT_STALE; node="FooCDN parent"; fresh=-45; age=200; latency=3,
       HIT_FRESH; node="reverse-proxy.example.com:80";
                  key="https://example.com/foo|Accept-Encoding:gzip"
]]></artwork></figure>

<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
“RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they appear in all capitals, as
shown here.</t>

<t>This document uses ABNF as defined in <xref target="RFC5234"/>, along with the “%s” extension for case sensitivity defined in <xref target="RFC7405"/>.</t>

</section>
</section>
<section anchor="the-cache-http-response-header" title="The Cache HTTP Response Header">

<t>The Cache HTTP response header indicates the handling of the request corresponding to the response it occurs within by caches along the path.</t>

<t>Its value is a Parameterised List <xref target="I-D.ietf-httpbis-header-structure"/>:</t>

<figure><artwork type="abnf"><![CDATA[
Cache   = sh-param-list
]]></artwork></figure>

<t>Each member of the parameterised list represents a cache that has handled the request.</t>

<t>The first member of the list represents the cache closest to the origin server, and the last member of the list represents the cache closest to the user agent (possibly including the user agent’s cache itself, if it chooses to append a value).</t>

<t>Caches determine when it is appropriate to add the Cache header field to a response. Some might decide to add it to all responses, whereas others might only do so when specifically configured to, or when the request contains a header that activates a debugging mode.</t>

<t>When adding a value to the Cache header field, caches SHOULD preserve the existing contents of the header, to allow debugging of the entire chain of caches handling the request.</t>

<t>Identifiers in the parameterised list members are expected to be cache-actions:</t>

<figure><artwork type="abnf"><![CDATA[
cache-action   = %s"HIT_FRESH"
               / %s"HIT_STALE"
               / %s"HIT_REFRESH_MODIFIED"
               / %s"HIT_REFRESH_NOT_MODIFIED"
               / %s"HIT_REFRESH_STALE"
               / %s"MISS"
               / %s"MISS_CLIENT"
               / %s"BYPASS"
               / %s"ERROR"
]]></artwork></figure>

<t>The semantics of cache-actions are:</t>

<t><list style="symbols">
  <t>HIT_FRESH - The cache used a fresh stored response to satisfy the request without going forward</t>
  <t>HIT_STALE - The cache used a stale stored response to satisfy the request without going forward</t>
  <t>HIT_REFRESH_MODIFIED - The cache had a stale stored response, went forward to validate it, and used the new response to satisfy the request</t>
  <t>HIT_REFRESH_NOT_MODIFIED - The cache had a stale stored response, went forward to validate it, and used the stored response to satisfy the request</t>
  <t>HIT_REFRESH_STALE - The cache had a stale stored response, went forward to validate it, and encountered a problem, so the stored response was used to satisfy the request</t>
  <t>MISS - The cache did not have a stored response, so the request was forwarded</t>
  <t>MISS_CLIENT - The cache had a stored response, but the client included directives (e.g., Pragma, Cache-Control) that prevented its use, so the request was forwarded</t>
  <t>BYPASS - The cache was configured to forward the request without attempting to use a stored response</t>
  <t>ERROR - The cache was unable to use a stored response or obtain one by going forward</t>
</list></t>

<t>Caches SHOULD use the most specific cache-action to a given response, but are not required to use all cache-actions. Future updates to this specification can add additional cache-actions.</t>

<t>Each member of the Cache header can also have any (or all, or none) of the following parameters:</t>

<figure><artwork type="abnf"><![CDATA[
node           = sh-string
fresh          = sh-integer
age            = sh-integer
cacheable      = sh-boolean
key            = sh-string
latency        = sh-integer
cl_nm          = sh-boolean
]]></artwork></figure>

<t>Their semantics are:</t>

<t><list style="symbols">
  <t>“node” - a string identifying for the cache node. MAY be a hostname, IP address, or alias.</t>
  <t>“fresh” - an integer indicating the cache’s estimation of the freshness lifetime (<xref target="RFC7234"/>, Section 4.2.1) of this response in seconds, including any locally applied configuration. MAY be negative.</t>
  <t>“age” - an integer indicating the cache’s estimation of the age (<xref target="RFC7234"/>, Section 4.2.3) of this response in seconds. MUST be 0 or greater.</t>
  <t>“cacheable” - a boolean indicating whether the cache can store this response, according to <xref target="RFC7234"/>, Section 3 and any locally applied configuration.</t>
  <t>“key” - a string representing the key that the cache has associated with this response. This might include the request URL, request headers, and other values.</t>
  <t>“latency” - an integer indicating the amount of time in milliseconds between the receipt of a complete set of request headers and sending the complete set of response headers of this response, from the viewpoint of the cache. Note that this may not include buffering time in transport protocols and similar delays.</t>
  <t>“cl_nm” - a boolean indicating whether the response to the client had a 304 Not Modified status code.</t>
</list></t>

<t>While all of these parameters are OPTIONAL, caches are encouraged to use the ‘node’ parameter to identify themselves.</t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>Information about a cache’s content can be used to infer the activity of those using it. Generally, access to sensitive information in a cache is limited to those who are authorised to access that information (using a variety of techniques), so this does not represent an attack vector in the general sense.</t>

<t>However, if the Cache header is exposed to parties who are not authorised to obtain the response it occurs within, it could expose information about that data.</t>

<t>For example, if an attacker were able to obtain the Cache header from a response containing sensitive information and access were limited to one person (or limited set of people), they could determine whether that information had been accessed before. This is similar to the information exposed by various timing attacks, but is arguably more reliable, since the cache is directly reporting its state.</t>

<t>Mitigations include use of encryption (e.g., TLS <xref target="RFC8446"/>)) to protect the response, and careful controls over access to response headers (as are present in the Web platform). When in doubt, the Cache header field can be omitted.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC8174" target='https://www.rfc-editor.org/info/rfc8174'>
<front>
<title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
<author initials='B.' surname='Leiba' fullname='B. Leiba'><organization /></author>
<date year='2017' month='May' />
<abstract><t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='8174'/>
<seriesInfo name='DOI' value='10.17487/RFC8174'/>
</reference>



<reference  anchor="RFC5234" target='https://www.rfc-editor.org/info/rfc5234'>
<front>
<title>Augmented BNF for Syntax Specifications: ABNF</title>
<author initials='D.' surname='Crocker' fullname='D. Crocker' role='editor'><organization /></author>
<author initials='P.' surname='Overell' fullname='P. Overell'><organization /></author>
<date year='2008' month='January' />
<abstract><t>Internet technical specifications often need to define a formal syntax.  Over the years, a modified version of Backus-Naur Form (BNF), called Augmented BNF (ABNF), has been popular among many Internet specifications.  The current specification documents ABNF. It balances compactness and simplicity with reasonable representational power.  The differences between standard BNF and ABNF involve naming rules, repetition, alternatives, order-independence, and value ranges.  This specification also supplies additional rule definitions and encoding for a core lexical analyzer of the type common to several Internet specifications.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='STD' value='68'/>
<seriesInfo name='RFC' value='5234'/>
<seriesInfo name='DOI' value='10.17487/RFC5234'/>
</reference>



<reference  anchor="RFC7405" target='https://www.rfc-editor.org/info/rfc7405'>
<front>
<title>Case-Sensitive String Support in ABNF</title>
<author initials='P.' surname='Kyzivat' fullname='P. Kyzivat'><organization /></author>
<date year='2014' month='December' />
<abstract><t>This document extends the base definition of ABNF (Augmented Backus-Naur Form) to include a way to specify US-ASCII string literals that are matched in a case-sensitive manner.</t></abstract>
</front>
<seriesInfo name='RFC' value='7405'/>
<seriesInfo name='DOI' value='10.17487/RFC7405'/>
</reference>



<reference anchor="I-D.ietf-httpbis-header-structure">
<front>
<title>Structured Headers for HTTP</title>

<author initials='M' surname='Nottingham' fullname='Mark Nottingham'>
    <organization />
</author>

<author initials='P' surname='Kamp' fullname='Poul-Henning Kamp'>
    <organization />
</author>

<date month='July' day='2' year='2018' />

<abstract><t>This document describes a set of data types and algorithms associated with them that are intended to make it easier and safer to define and handle HTTP header fields.  It is intended for use by new specifications of HTTP header fields as well as revisions of existing header field specifications when doing so does not cause interoperability issues.</t></abstract>

</front>

<seriesInfo name='Internet-Draft' value='draft-ietf-httpbis-header-structure-07' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-httpbis-header-structure-07.txt' />
</reference>



<reference  anchor="RFC7234" target='https://www.rfc-editor.org/info/rfc7234'>
<front>
<title>Hypertext Transfer Protocol (HTTP/1.1): Caching</title>
<author initials='R.' surname='Fielding' fullname='R. Fielding' role='editor'><organization /></author>
<author initials='M.' surname='Nottingham' fullname='M. Nottingham' role='editor'><organization /></author>
<author initials='J.' surname='Reschke' fullname='J. Reschke' role='editor'><organization /></author>
<date year='2014' month='June' />
<abstract><t>The Hypertext Transfer Protocol (HTTP) is a stateless \%application- level protocol for distributed, collaborative, hypertext information systems.  This document defines HTTP caches and the associated header fields that control cache behavior or indicate cacheable response messages.</t></abstract>
</front>
<seriesInfo name='RFC' value='7234'/>
<seriesInfo name='DOI' value='10.17487/RFC7234'/>
</reference>




    </references>

    <references title='Informative References'>





<reference  anchor="RFC8446" target='https://www.rfc-editor.org/info/rfc8446'>
<front>
<title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
<author initials='E.' surname='Rescorla' fullname='E. Rescorla'><organization /></author>
<date year='2018' month='August' />
<abstract><t>This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t><t>This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t></abstract>
</front>
<seriesInfo name='RFC' value='8446'/>
<seriesInfo name='DOI' value='10.17487/RFC8446'/>
</reference>




    </references>



  </back>

<!-- ##markdown-source:
H4sIAFBpdlsAA71ZbXPjthH+zl+BKtPJOSPJvjunueh6bR2/9DTjt9q+yWQ6
HQ9EQhTmSIIBQOuU1PntfXYByqRkn9P0xR9kkQD2fZ/dhUajUeK1L9RE3CyU
OJQpPt/f3FyKK+VqUzk8KZkpm8jZzKq7SbslvMxMWskShzMr535UGe91lS9k
OUpp22jB20Z7e0kmPba92nv5JknxNTd2NRHOZ0miazsR3jbOv9rb+3bvVSKt
khPxV1UpK4tkaezH3JqmniQf1QpP2URMK69spfzoiNgmifOyym5lYSrwWCmX
1Hoi/u5NOhT40FWmKj8Uzlhv1dzh26qMX7zVKZZSU9YyfimxGUu6KnSl/pEk
svELYyeJGCUCf7pyE3E2FudrXfl1MMOZtB83V4zNZaV/kl6baiJOpPPFihdU
KXUxESWs9hf6GEMjXmgsxF94X7vJ7u5yuRy3q7tJUhlbgtSdgkDi6uTw1cuX
305gxGr+sJAko9FIyBm0g1JJcmOE1JnI1KzJc0g2DB5mFzlh5l5VQta1qjIR
HOZgNiGFbUMgUx6i4qRYmKXwC7USC1i8UBk9YN+PjXJ+jBDSTrhapXquU1YY
Bs3wADZ+Ib2oSSCdKoHToqkpKJzQXkB4lulLJ9LGWniApSOOpclUMY46wQ7q
9pw+vLm9CrImyVewgzg+mt5cXE1EXSjpSKbS3ClwJYlUyrLMFPgoUTezIor3
FYwDBbRzUEAU2gVR+BSHNMSgc3jbQGJo8MfWL7n2i2Y2RsDsknt2p6Oj3ULO
VOF2u7H/p3FgURrQtiol1V6wyYeiqVgUt1DZTmQHvl0m7PjISRvm0SW+S9Sv
AtEUHsmhBLKHFVHPi0vBrr3bzRejWuLsluDXCp4qnGEvs4AdByHpfAPvVbw6
Pb45EfCnpJj7qOwQ3JM1987CWCs/HyMpdgEeu5/FDVaP3F7qDMGWJF9Q5luT
NezP/19gJ8kHyi/fVAjYYjXkRYf8rRDMxIhegFzLhHwQuDdVingka0CGmfGL
jaP02q0qLz+JxoHrnbQrkQMAARKIO79UIKJLBDXBEses44jaSrRMzYFXoCgc
9CnUUFRqGeyxVjfIJ5CPRTYUA4bywUPE142tjVOgf4JX6pMkvoCTX375pX1K
+AyAbnp9/RbpmKl3gxNjDo/OhcpyNXgr5uC2eDfa//qtQEy9A6a/FQXMVqWr
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
tr8IzmDH5F8etyXMxh4AAA==

-->

</rfc>

